<!DOCTYPE HTML>
<!--
    Massively by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
        <title>Mileage Data Visualization – Julian Zavala Ramirez</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <link rel="stylesheet" href="assets/css/main.css" />
        <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>

        <style>
            .table-controls {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 1rem;
                margin-top: 1.5rem;
                flex-wrap: wrap;
            }
            .metric-label {
                font-weight: 600;
                letter-spacing: 0.03em;
                text-transform: uppercase;
                font-size: 0.9rem;
            }
            .table-wrapper {
                overflow-x: auto;
                margin-top: 1.5rem;
            }
            table#dataTable {
                width: 100%;
                min-width: 900px;
                border-collapse: collapse;
            }
            #dataTable th,
            #dataTable td {
                padding: 0.6rem 0.8rem;
                border: 1px solid rgba(255,255,255,0.08);
                text-align: right;
                font-size: 0.9rem;
            }
            #dataTable th:first-child,
            #dataTable td:first-child {
                text-align: left;
                white-space: nowrap;
                font-weight: 600;
            }
            #dataTable thead {
                background: rgba(255,255,255,0.02);
            }
            #dataTable tbody tr:nth-child(odd) {
                background: rgba(255,255,255,0.02);
            }
            #dataTable tbody tr:nth-child(even) {
                background: rgba(255,255,255,0.04);
            }
        </style>
    </head>
    <body class="is-preload">

        <!-- Wrapper -->
        <div id="wrapper" class="fade-in">

            <!-- Main -->
            <div id="main">

                <!-- Featured Post -->
                <article class="post featured">
                    <header class="major">
                        <h2>Car Mileage Data Visualization</h2>
                        <p>
                            This project tracks my real-world driving data in Wisconsin, including miles per fill,
                            MPG, gas prices, and total fill cost. I wrote a Java script to convert my handwritten
                            mileage log into a JSON dataset, then used JavaScript to generate monthly summaries
                            directly in the browser.
                        </p>
                    </header>

                    <p>
                        Use the arrows below to switch between different views of the same data:
                        average MPG, average gas price, total miles driven, and total monthly fuel cost.
                        Rows represent years, columns represent months (Jan–Dec).
                    </p>

                    <!-- Controls -->
                    <div class="table-controls">
                        <button id="prevMetric" class="button small">⟵ Previous</button>
                        <span id="metricLabel" class="metric-label">Average MPG per Month</span>
                        <button id="nextMetric" class="button small">Next ⟶</button>
                    </div>

                    <!-- Scrollable table -->
                    <div class="table-wrapper">
                        <table id="dataTable">
                            <thead></thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </article>

            </div>

            <!-- Footer -->
            <footer id="footer">
                <section class="split contact">
                    <section>
                        <h3>Email</h3>
                        <p><a href="mailto:jzavala8942@gmail.com">jzavala8942@gmail.com</a></p>
                    </section>
                    <section>
                        <h3>Social</h3>
                        <ul class="icons alt">
                            <li><a href="https://github.com/jzavala5114" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
                            <li><a href="https://www.linkedin.com/in/julian-zavala-276a00257" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
                        </ul>
                    </section>
                </section>
            </footer>

            <!-- Copyright -->
            <div id="copyright">
                <ul><li>&copy; Untitled</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
            </div>

        </div>

        <!-- Scripts (Massively template) -->
        <script src="assets/js/jquery.min.js"></script>
        <script src="assets/js/jquery.scrollex.min.js"></script>
        <script src="assets/js/jquery.scrolly.min.js"></script>
        <script src="assets/js/browser.min.js"></script>
        <script src="assets/js/breakpoints.min.js"></script>
        <script src="assets/js/util.js"></script>
        <script src="assets/js/main.js"></script>

        <!-- Mileage table script -->
        <script>
            (async function () {
                const resp = await fetch('data.json');
                const json = await resp.json();

                const labels = json.labels || [];
                const ds = json.datasets || {};

                const YEARS = [2023, 2024, 2025];
                const MONTH_NAMES = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

                // Aggregate per year+month
                const monthly = {};
                YEARS.forEach(y => {
                    monthly[y] = Array.from({ length: 12 }, () => ({
                        miles: 0,
                        cost: 0,
                        mpgSum: 0,
                        mpgCount: 0,
                        priceSum: 0,
                        priceCount: 0
                    }));
                });

                labels.forEach((label, i) => {
                    const d = new Date(label);
                    const y = d.getFullYear();
                    const m = d.getMonth();
                    if (!monthly[y] || m < 0 || m > 11) return;

                    const entry = monthly[y][m];
                    const miles = Number(ds.miles?.[i] ?? 0);
                    const mpg = Number(ds.mpg?.[i] ?? 0);
                    const price = Number(ds.pricePerGallon?.[i] ?? 0);
                    const cost = Number(ds.cost?.[i] ?? 0);

                    if (!Number.isNaN(miles)) entry.miles += miles;
                    if (!Number.isNaN(cost)) entry.cost += cost;
                    if (!Number.isNaN(mpg)) { entry.mpgSum += mpg; entry.mpgCount++; }
                    if (!Number.isNaN(price)) { entry.priceSum += price; entry.priceCount++; }
                });

                const metrics = [
                    {
                        key: 'mpg',
                        title: 'Average MPG per Month',
                        compute: cell => cell.mpgCount ? cell.mpgSum / cell.mpgCount : null,
                        decimals: 1
                    },
                    {
                        key: 'price',
                        title: 'Average Gas Price per Gallon (USD)',
                        compute: cell => cell.priceCount ? cell.priceSum / cell.priceCount : null,
                        decimals: 2
                    },
                    {
                        key: 'miles',
                        title: 'Total Miles Driven per Month',
                        compute: cell => cell.miles || null,
                        decimals: 0
                    },
                    {
                        key: 'cost',
                        title: 'Total Fuel Cost per Month (USD)',
                        compute: cell => cell.cost || null,
                        decimals: 0
                    }
                ];

                let currentMetricIndex = 0;

                const thead = document.querySelector('#dataTable thead');
                const tbody = document.querySelector('#dataTable tbody');
                const metricLabel = document.getElementById('metricLabel');

                function formatValue(val, decimals) {
                    if (val == null) return '-';
                    return val.toFixed(decimals);
                }

                function renderTable() {
                    const metric = metrics[currentMetricIndex];
                    metricLabel.textContent = metric.title;

                    // Header
                    let headHtml = '<tr><th>Year</th>';
                    MONTH_NAMES.forEach(name => {
                        headHtml += `<th>${name}</th>`;
                    });
                    headHtml += '</tr>';
                    thead.innerHTML = headHtml;

                    // Body
                    let bodyHtml = '';
                    YEARS.forEach(year => {
                        bodyHtml += `<tr><td>${year}</td>`;
                        for (let m = 0; m < 12; m++) {
                            const cell = monthly[year][m];
                            const val = metric.compute(cell);
                            bodyHtml += `<td>${formatValue(val, metric.decimals)}</td>`;
                        }
                        bodyHtml += '</tr>';
                    });
                    tbody.innerHTML = bodyHtml;
                }

                document.getElementById('prevMetric').addEventListener('click', () => {
                    currentMetricIndex = (currentMetricIndex - 1 + metrics.length) % metrics.length;
                    renderTable();
                });

                document.getElementById('nextMetric').addEventListener('click', () => {
                    currentMetricIndex = (currentMetricIndex + 1) % metrics.length;
                    renderTable();
                });

                renderTable();
            })();
        </script>

    </body>
</html>
