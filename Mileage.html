<!DOCTYPE HTML>
<!--
    Massively by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
        <title>Mileage Data Visualization – Julian Zavala Ramirez</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <link rel="stylesheet" href="assets/css/main.css" />
        <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>

        <!-- Chart.js -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        <style>
            .chart-controls {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 1rem;
                margin-top: 1.5rem;
                flex-wrap: wrap;
            }
            .metric-label {
                font-weight: 600;
                letter-spacing: 0.03em;
                text-transform: uppercase;
                font-size: 0.9rem;
                text-align: center;
            }
            .chart-wrapper {
                margin-top: 2rem;
            }
            .chart-card {
                background: #1e1f23;
                border-radius: 8px;
                padding: 1.5rem;
            }
            .chart-card h3 {
                margin: 0 0 0.75rem 0;
                font-size: 1.1rem;
                text-align: center;
            }
            .chart-container {
                position: relative;
                width: 100%;
                height: 420px; /* controls chart height */
            }
            #metricChart {
                width: 100%;
                height: 100%;
            }
        </style>
    </head>
    <body class="is-preload">

        <!-- Wrapper -->
        <div id="wrapper" class="fade-in">

            <!-- Main -->
            <div id="main">

                <!-- Featured Post -->
                <article class="post featured">
                    <header class="major">
                        <h2>Car Mileage Data Visualization</h2>
                        <p>
                            This project tracks my real-world driving data in Wisconsin, including miles per fill,
                            MPG, gas prices, and total fill cost. I wrote a Java script to convert my handwritten
                            mileage log into a JSON dataset, then used Chart.js to visualize monthly trends
                            directly in the browser.
                        </p>
                    </header>

                    <p>
                        Use the arrows below to switch between views: average MPG, average gas price, total miles,
                        and total monthly fuel cost. Months are along the x-axis (Jan–Dec), and each color
                        represents a different year.
                    </p>

                    <!-- Controls -->
                    <div class="chart-controls">
                        <button id="prevMetric" class="button small">⟵ Previous</button>
                        <span id="metricLabel" class="metric-label">Average MPG per Month</span>
                        <button id="nextMetric" class="button small">Next ⟶</button>
                    </div>

                    <!-- Chart -->
                    <div class="chart-wrapper">
                        <div class="chart-card">
                            <h3 id="chartTitle">Average MPG per Month</h3>
                            <div class="chart-container">
                                <canvas id="metricChart"></canvas>
                            </div>
                        </div>
                    </div>
                </article>

            </div>

            <!-- Footer -->
            <footer id="footer">
                <section class="split contact">
                    <section>
                        <h3>Email</h3>
                        <p><a href="mailto:jzavala8942@gmail.com">jzavala8942@gmail.com</a></p>
                    </section>
                    <section>
                        <h3>Social</h3>
                        <ul class="icons alt">
                            <li><a href="https://github.com/jzavala5114" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
                            <li><a href="https://www.linkedin.com/in/julian-zavala-276a00257" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
                        </ul>
                    </section>
                </section>
            </footer>

            <!-- Copyright -->
            <div id="copyright">
                <ul><li>&copy; Untitled</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
            </div>

        </div>

        <!-- Scripts (Massively template) -->
        <script src="assets/js/jquery.min.js"></script>
        <script src="assets/js/jquery.scrollex.min.js"></script>
        <script src="assets/js/jquery.scrolly.min.js"></script>
        <script src="assets/js/browser.min.js"></script>
        <script src="assets/js/breakpoints.min.js"></script>
        <script src="assets/js/util.js"></script>
        <script src="assets/js/main.js"></script>

<!-- Mileage bar-graph script -->
<script>
(async function () {
    const resp = await fetch('data.json');
    const json = await resp.json();

    const labels = json.labels || [];
    const ds = json.datasets || {};

    const YEARS = [2023, 2024, 2025];
    const MONTH_NAMES = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

    const monthly = {};
    YEARS.forEach(y => {
        monthly[y] = Array.from({ length: 12 }, () => ({
            miles: 0,
            cost: 0,
            mpgSum: 0,
            mpgCount: 0,
            priceSum: 0,
            priceCount: 0
        }));
    });

    labels.forEach((label, i) => {
        const d = new Date(label);
        const y = d.getFullYear();
        const m = d.getMonth();
        if (!monthly[y] || m < 0 || m > 11) return;

        const entry = monthly[y][m];
        const miles = Number(ds.miles?.[i] ?? 0);
        const mpg = Number(ds.mpg?.[i] ?? 0);
        const price = Number(ds.pricePerGallon?.[i] ?? 0);
        const cost = Number(ds.cost?.[i] ?? 0);

        if (!Number.isNaN(miles)) entry.miles += miles;
        if (!Number.isNaN(cost)) entry.cost += cost;
        if (!Number.isNaN(mpg)) { entry.mpgSum += mpg; entry.mpgCount++; }
        if (!Number.isNaN(price)) { entry.priceSum += price; entry.priceCount++; }
    });

    const metrics = [
        {
            key: 'mpg',
            title: 'Average MPG per Month',
            yAxis: 'MPG',
            compute: cell => cell.mpgCount ? cell.mpgSum / cell.mpgCount : null,
            decimals: 1
        },
        {
            key: 'price',
            title: 'Average Gas Price per Gallon (USD)',
            yAxis: 'USD',
            compute: cell => cell.priceCount ? cell.priceSum / cell.priceCount : null,
            decimals: 2
        },
        {
            key: 'miles',
            title: 'Total Miles Driven per Month',
            yAxis: 'Miles',
            compute: cell => cell.miles || null,
            decimals: 0
        },
        {
            key: 'cost',
            title: 'Total Fuel Cost per Month (USD)',
            yAxis: 'USD',
            compute: cell => cell.cost || null,
            decimals: 0
        }
    ];

    let currentMetricIndex = 0;
    const metricLabel = document.getElementById('metricLabel');
    const chartTitle = document.getElementById('chartTitle');
    const ctx = document.getElementById('metricChart').getContext('2d');
    let chart = null;

    function buildChartData(metric) {
        const datasets = YEARS.map((year) => {
            const data = [];
            for (let m = 0; m < 12; m++) {
                const cell = monthly[year][m];
                const val = metric.compute(cell);
                data.push(val == null ? null : Number(val.toFixed(metric.decimals)));
            }
            return { label: String(year), data: data };
        });
        return { labels: MONTH_NAMES, datasets };
    }

    function renderChart() {
        const metric = metrics[currentMetricIndex];
        metricLabel.textContent = metric.title;
        chartTitle.textContent = metric.title;

        const data = buildChartData(metric);

        if (chart) chart.destroy();

        chart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                scales: {
                    x: {
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    },
                    y: {
                        title: { display: true, text: metric.yAxis, color: '#ffffff' },
                        ticks: { color: '#ffffff' },
                        grid: { color: 'rgba(255,255,255,0.1)' },
                        beginAtZero: true
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        labels: { color: '#ffffff' }
                    },
                    title: {
                        display: true,
                        text: metric.title,
                        color: '#ffffff',
                        font: { size: 16, weight: 'bold' }
                    },
                    tooltip: { enabled: true }
                }
            }
        });
    }

    document.getElementById('prevMetric').addEventListener('click', () => {
        currentMetricIndex = (currentMetricIndex - 1 + metrics.length) % metrics.length;
        renderChart();
    });
    document.getElementById('nextMetric').addEventListener('click', () => {
        currentMetricIndex = (currentMetricIndex + 1) % metrics.length;
        renderChart();
    });

    renderChart();
})();
</script>


    </body>
</html>

